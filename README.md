# Mecanum/Differential Drive MPC Trajectory Generation

This project implements a Model Predictive Control (MPC) solution for navigating a robot with either mecanum wheels or a differential drive configuration through an environment with static obstacles.

![Simulation Screenshot](images/generatedTrajectory.png)

## Features

*   Solves an MPC problem to find an optimal trajectory.
*   Supports both Mecanum and Differential Drive (Tank) kinematics.
*   Includes obstacle avoidance using bounding circles.
*   Visualizes the robot path, orientation, obstacle positions (with orientation), and wheel velocities in Rerun.
*   Uses CasADi for optimization modeling.

## Setup and Installation (using uv)

This project uses `uv` for environment and dependency management.

1.  **Install uv:** If you don't have `uv` installed, follow the instructions [here](https://github.com/astral-sh/uv#installation).

2.  **Create and Sync Environment:** Navigate to the project directory in your terminal and run:
    ```bash
    uv sync
    ```
    This command will create a virtual environment (if it doesn't exist) and install all the dependencies listed in `pyproject.toml`.

## Running the Simulation

Activate the virtual environment created by `uv`:

```bash
# On Linux/macOS
source .venv/bin/activate

# On Windows (Command Prompt)
.venv\Scripts\activate.bat

# On Windows (PowerShell)
.venv\Scripts\Activate.ps1
```

Then, run the main script:

*   **To run with default Mecanum drive kinematics:**
    ```bash
    python main.py
    ```

*   **To run with Differential drive (Tank) kinematics:**
    ```bash
    python main.py --differential-drive
    ```

A Rerun viewer window should automatically open, displaying the simulation.

## Code Structure

*   `main.py`: The main script that sets up the MPC problem, solves it, and orchestrates the visualization.
*   `utils.py`: Contains helper functions for SE(2) math, geometry (like circle generation), kinematics calculations (mecanum and tank), and goal validation.
*   `visualization.py`: Contains functions dedicated to logging data to Rerun.
*   `pyproject.toml`: Defines project metadata and dependencies for `uv`.
*   `uv.lock`: The lockfile generated by `uv` for reproducible installs.
